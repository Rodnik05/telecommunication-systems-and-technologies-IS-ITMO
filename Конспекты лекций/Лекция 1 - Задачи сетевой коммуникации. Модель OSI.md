## План лекции:
* [Проблемы сетевой коммуникации](#problems)
* [Модель ISO - OSI. Зачем нужно в ней разбираться?](#osi-model)
* [Уровни модели OSI](#layers-of-osi)
* [Зачем нужна многоуровневая адресация?](#multilevel-addressing)


---
<a id="problems"></a>
# Проблемы сетевой коммуникации

#### 1. Архитектурный аспект
* Необходимость обеспечить взаимодействие разнообразных систем (архитектура ОС, кодировка, разрядность и т.п.)
* Необходимость работать через разное оборудование во время одного сеанса связи
* Необходимость организационно разграничивать управление в крупных сетях

#### 2. Технический аспект
<details>
  <summary>Задержка(Latency)</summary>
 Переменное время, которое требуется для передачи данных от одного источника к другому
</details>

<details>
  <summary>Пропускная способность(Bandwidth)</summary>
 Передача объема данных за заданный промежуток времени. Снижение скорости передачи. Стабильность канала. Перегрузка сети.
</details>

<details>
  <summary>Помехи(Interference)</summary>
 Любые помехи, искажающие сигнал
</details>

<details>
  <summary>Потеря пакетов(Packet loss)</summary>
 Потеря или повреждение пакетов при передаче
</details>

<details>
  <summary>Угрозы безопасности(Security threats)</summary>
Проблемы безопасности и конфигурации, авторизация и аутентификация, DoS и т.п.
</details>

<details>
  <summary>Проблемы с конфигурацией и совместимостью(Configuration and compatibility)</summary>
Проблемы согласования конфигураций, протоколов, ключей и т.п.
</details>

<details>
  <summary>Проблемы масштабируемости(Scalability challenges)</summary>
 Проблемы масштаба и системной сложности
</details>

---
<a id="osi-model"></a>
# Модель ISO - OSI

#### Предпосылки появления модели
* Необходимость решения организационных и технических проблем
* Монолиты
* Потребность в открытых стандартах
* Потребность в совместном использовании лучших компонентов

#### Основные принципы
* Выделение логически изолированных этапов коммуникации
* Реализация поддержки этапов в виде программных или аппаратных модулей - "черных ящиков"
* Регламентирование интерфейсов
* Описание функций и задач модулей без описания алгоритмов

#### Модель OSI
![](/images/Уровни_модели_OSI.png)
В модели OSI 7 уровней:
1. Физический уровень
2. Канальный уровень
3. Сетевой уровень
4. Транспортный уровень
5. Сеансовый уровень
6. Уровень Представления
7. Прикладной уровень

Данные попадают в верх этого уровня. На каждом уровне добавляется свой служебный заголовок, или ___headder___, таким образом совершается ___инкаспуляцию___. На Канальном уровне добавляется ___data trailer___. Он содержит внутри себя коды для обнаружения ошибок, которые помогают выявить повреждения во время передачи, также он является индикатором окончания кадра.
Количество информации не меняется, меняется объем данных. До ___транспортного уровня___ он увеличивается(если не учитывать сжатие на ___уровне представления___), затем он разбивается на блоки меньшего размера на ___транспортном уровне___, после чего каждый из блоков тоже увеличивается в размерах.

![](/images/Разбиение_сообщения_в_OSI.png)

>Модель OSI является абстракцией, в реальных сетевых стеках всегда было меньше уровней. В TCP/IP - 4 уровня

#### Возможности
* Абстрагирование архитектурных слоев
* Реализация:
	1. установления соединений
	2. подтверждений
	3. кодирования
	4. безопасности и т.д.
* Возможность масштабирования систем

#### Протокол и слой стека
* Сетевой стек - набор протоколов
* Слой - уровень стека со специфичными задачами
* Протокол - спецификация на реализацию части функций слоя
* Строгая и нестрогая инкапсуляция
* В OSI протоколов нет. Есть только слои. Можно считать, что они тождественны

---
<a id="layers-of-osi"></a>
# Уровни модели OSI

#### Прикладной уровень(Application layer)
Назначение:
Отвечает за предоставление командного интерфейса приложениям или пользователям, переду файлов, потоков данных и т.п.
Идентификация, аутентификация и авторизация пользователей.
Предоставление приложениям информации об ошибках

Примеры:
HTTP, HTTPS, FTP, SMTP, Telnet, DNS, DHCP

> Почти с любым протоколом можно взаимодействовать без прикладного ПО, набирая руками команды, если протокол нешифрованный.

#### Уровень представления(Presentation layer)
Назначение:
Сжатие и шифрование данных, а также символьная кодировка.

Примеры протоколов:
SSL, TLS, ASCII, Unicode

#### Сеанcовый уровень (Session layer)
Назначение:
Устанавливает, управляет и завершает соединение между приложениями.

Примеры протоколов:
RPC(Remote Procedure Call Protocol). 
>RPC не является чисто прикладным протоколом, так как он также использует функциональность прикладного уровня, например механизмы аутентификации.


#### Транспортный уровень
Назначение:
* обеспечение надежной передачи данных между устройствами
* гарантия, что данные поступают без ошибок и в правильном порядке
* сегментация потока

Примеры протоколов:
TCP, UDP, SCTP(Stream Control Transmission Protocol)
> UDP не делает надежную доставку в чистом виде.
>> SCTP, в отличие от TCP и UDP, умеет в многопоточность


#### Сетевой уровень(Network layer)
Назначение:
* решает задачу доставки данных по составной сети
* межсетевую адресацию
* трансляцию физических адресов в сетевые
* управление перегрузкой
* маппинг сетевых адресов в физические
* маршрутизация

Примеры протоколов:
IPv4, IPv6, ICMP, IGMP, RIP, BGP, ARP


#### Канальный уровень (Data link layer)
Назначение:
* отвечает за передачу кадров данных между узлами в локальной сети по физическому уровню
* обеспечивает обнаружение и исправление ошибок

Примеры протоколов:
Ethernet, Wi-Fi, Bluetooth


#### Физический уровень(Physical layer)
Назначение:
* физическая передача данных через сетевые кабели, разъемы и сетевые устройства
* определяет тип кабелей и разъемов, назначение контактов и формат физический сигналов


Примеры:
IEEE 802.15(Bluetooth), IRDA, EIA-RS-232, EIA-422, Ethernet, DLS, ISDN, IEEE 802.11


#### Зачем нужна модель OSI
##### Понимание
Модель OSI дает инструменты для понимания работы различных компонентов компьютерных сетей и того, как они работают вместе, а также различных протоколов, технологий и стандартов

##### Идеология
Используется при проектировании и разработке сетевых продуктов и технологий и упоминается во многих отраслевых стандартах и протоколах

##### Терминология
Модель OSI является дает общий язык и дает основу для понимание и обсуждения концепций компьютерных сетей





---

<a id="multilevel-addressing"></a>
# Многоуровневая адресация
Адреса есть на каждом уровне модели. Хосты адресуются на канальном и сетевом уровне. Зачем их передавать их на этих двух уровнях?

![](/images/Эпическая_картина.png)
Это схема составной сети. На ней 3 локальных сети. У Сети I есть 3 сетевых узла, а у Сети II и Сети III есть 2 сетевых узла.
> Сетевой узел имеет сетевой адрес и канальный адрес.

Также есть 2 маршрутизатора(роутера), они соединяют локальные сети на основании общего сетевого протокола. Маршрутизатор имеет узел в каждой локальной сети, к которой он подключен.

Канальный адрес(___MAC адрес___)  представлен тремя латинскими буквами. Это адрес, который производитель дал устройству.

Адрес сетевого уровня представлен двумя цифрами через тире, например IP адрес.

В круглых скобочках написан ___шлюз___. Это сетевой адрес узла, через который мы выходим во внешнюю сеть(адрес маршрутизатора в локальной сети)

Также на схеме есть таблица маршрутизация, в которой содержатся способы отправить пакет в другую локальную сеть. Если у нас нет узла маршрутизатора, который имеет доступ к другой сети, то мы посылаем пакеты на другой маршрутизатор, от которого уже пытаемся отправить те же пакеты.
>Рассмотрим последнюю строчку в таблице маршрутизация M1 `[3-0]-[2-1]-[2-2]`:
>`[3-0]` означает, что маршрутизатору нужно добраться до Сети III.
>Он выйдет через порт `[2-1]` в локальную сеть II, затем он внутри сети II пойдет на маршрутизатор М2 по шлюзу `[2-2]`, после чего, он будет использовать таблицу маршрутизации М2.

Рассмотрим подробнее процесс передачи пакетов, чтобы понять, почему нужно несколько заголовков
![](/images/Пакеты_и_заголовки.png)
Сетевой адрес мы не меняем, так как мы хотим знать отправителя и получателя. Но мы меняем MAC адреса, которые являются заголовками на канальном уровне, потому что мы переходим из одной локальной сети в другую. 

>Канальный протокол может быть разный в разных локальных сетях. Но протокол сетевого уровня является "общим языком" и должен быть одинаковым, чтобы разные локальные сети могли друг с другом общаться

> Как узнается MAC адрес получателя в локальной сети?
> В IPv4 есть ARP(Address resolution protocol) протокол. Отправитель отправляет по протоколу ARP в локальную сеть запрос с MAC адресом получается, а ему отвечает тот узел, у которого MAC адрес совпадает.